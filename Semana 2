## Detalhes do projeto da Semana 2

Detalhes dos requisitos do projeto:

link trello

|ETL no Qlik Desktop|

Depois de extrair os dados da organização hermex, fiz a transformação dos dados da seguinte forma:

Atribui nome as tabelas e padronizei o nome da coluna id_produto das tabelas para que o Qlik Sense pudesse fazer o relacionamento das tabelas e acabar com o problema de chaves sintéticas.

Além disso renomeei o nome do campo Qunatidade da tabelas "estoque" para "quantidade estoque" para não haver o relacionamento com a coluna "quantidade" de outra tabela.

Outro detalhe é que o campo UF tinha os registro dos estados da seguinte forma: "BR-PA", sendo que interessa para o registro apenas o PA.

Desta forma utilizei a função replace do Qlik Sense no carregamento de dados para o registro apresentar somente o as siglas da UF.

    >Replace(UF, 'BR-', '') as UF

O campo ESTADO estava sem registro, diante disso criei uma condicional no Qlik Sense na parte de carregamento de dados para poder poder preencher os registros dos ESTADOS.

    >IF(UF = 'BR-PA' or UF = 'Pará','') 

E assim por diante em todos os UF registrados 

No campo UF com o registro DF relacionado com Distrito Federal, coloquei a palavra Brasília para o gráfico de mapas do Qlik Sense identificar o DF no Brasil.

O campo da "Data da compra" tem também com registro a hora da compra. Por isso usei a função DATE para extrair somente a data do campo.

    >Time("Data da compra") as [Hora da Compra]

e a criei outro campo para extrair apenas a hora da compra.

    >Time("Data da compra") as [Hora da Compra]

-As mesmas correções fazer no campo Data Previsão e data de entrega.

    Date("Data previsão") as [Data Prevista],
    Time("Data previsão") as [Hora Prevista],

E ASSIM FICOU O SCRIPT DO QLIK SENSE:

Produtos:
LOAD
    id_produto,
    categoria_produto,
    preço
FROM [lib://Base de Dados Empresa Hermex Log/base-de-dados-Hermex.xlsx]
(ooxml, embedded labels, table is Produtos);

Estoque:
LOAD
    "ID Produto" as id_produto,
    "Data atualização",
    Quantidade as [Quantidade Estoque]
FROM [lib://Base de Dados Empresa Hermex Log/base-de-dados-Hermex.xlsx]
(ooxml, embedded labels, table is Estoque);

Veículos:
LOAD
    "ID veículos" as [ID Veículo],
    Tipo,
    Status
FROM [lib://Base de Dados Empresa Hermex Log/base-de-dados-Hermex.xlsx]
(ooxml, embedded labels, table is Veículos);

Pedidos:
LOAD
    "ID Pedido",
    "ID Produto" as id_produto,
    Quantidade,
    "ID Veículo",
    "Status do pedido",
    
    /*"Data da compra",*/
    
    Date("Data da compra") as [Data da Compra],
    Time("Data da compra") as [Hora da Compra],
    
    /*"Data de entrega"*/
    
    Date("Data de entrega") as [Data de Entrega],
    Time("Data de entrega") as [Hora de Entrega],
    
    
    /*"Data previsão",*/
    
    Date("Data previsão") as [Data Prevista],
    Time("Data previsão") as [Hora Prevista],
    
    
    Replace(UF, 'BR-', '') as UF,
	IF(UF = 'BR-SP' or UF = 'São Paulo', 'São Paulo',
       IF(UF = 'BR-PA' or UF = 'Pará', 'Pará',
          IF(UF = 'BR-PI' or UF = 'Piauí', 'Piauí',
             IF(UF = 'BR-MG' or UF = 'Minas Gerais', 'Minas Gerais', 
             	IF(UF = 'BR-ES', 'Espírito Santo',
                	IF(UF = 'BR-RJ', 'Rio de Janeiro',
                    	IF(UF = 'BR-RN', 'Rio Grande do Norte',
                        	IF(UF = 'BR-MS', 'Mato Grosso do Sul',
                            	IF(UF = 'BR-DF', 'Brasília',
                                	IF(UF = 'BR-AP', 'Amapá',
                                    	IF(UF = 'BR-CE', 'Ceará',
                                            IF(UF = 'BR-PR', 'Paraná',
												                      IF(UF = 'BR-RR', 'Roraima',
													                      IF(UF = 'BR-TO', 'Tocantins',
														                      IF(UF = 'BR-SC', 'Santa Catarina',
															                      IF(UF = 'BR-AM', 'Amazonas',
																                          IF(UF = 'BR-PE', 'Pernambuco',
                                                                	IF(UF = 'BR-RS','Rio Grande do Sul',
                                                                    	IF(UF = 'BR-RO', 'Rondônia',
                                                                        	IF(UF= 'BR-MT', 'Mato Grosso',
                                                                            	IF(UF='BR-MA', 'Maranhão',
                                                                                	IF(UF='BR-AC', 'Acre',
                                                                                    	IF(UF='BR-AL', 'Alagoas', 
                                                                                        	IF(UF='BR-BA', 'Bahia', 
                                                                                            	IF(UF='BR-GO', 'Goiás', 
                                                                                                	IF(UF='BR-PB', 'Paraíba',
                                                                                                    	IF(UF='BR-SE', 'Sergipe',''))))))))))))))))))))))))))) as ESTADO
       
                                											
                        


FROM [lib://Base de Dados Empresa Hermex Log/base-de-dados-Hermex.xlsx]
(ooxml, embedded labels, table is Pedidos);






